\chapter{Theoretical introduction}\label{chapter:theoretical-introduction}

\todo

\section{Antiferromagnetic ordering in the Hubbard model}\label{sec:antiferromagnetic-ordering-hubbard}

Consider the ordinary Hubbard model:
\begin{equation}\label{eq:hubbard-model}
	\hat H = 
	-t \sum_{\langle ij \rangle} \sum_\sigma \hat c_{i\sigma}^\dagger \hat c_{j\sigma}
	+ U \sum_i \hat n_{i\uparrow} \hat n_{i\downarrow}
	\qquad
	t, U  > 0
\end{equation}
The two competing mechanisms are site-hopping of amplitude $t$ and local repulsion of amplitude $U$. For this model defined \textbf{on a bipartite lattice at half filling} and fixed electron number, it is well known \cite{hirsch1985hubbard} that, below a certain critical temperature $T_c$ and above some (small) critical repulsion $U_c/t$, the ground-state acquires antiferromagnetic ($\mathrm{AF}$) long-range ordering. schematically depicted in Fig.~\ref{subfig:antiferromagnet-phase}. The mechanism for the formation of the $\mathrm{AF}$ phase takes advantage of virtual hopping, as described in App.~\ref{appendix:superexchange-virtual-hopping}; the Mean-Field Theory (MFT) treatment of ferromagnetic-antiferromagnetic orderings in $2\mathrm{D}$ Hubbard lattices is discussed in  App.~\ref{appendix:mean-field-hubbard}.

\begin{figure}
	\centering
	\subfloat[Antiferromagnetic phase.]{
		\input{chapters/theoretical-introduction/pictures/antiferromagnet-phase}
		\label{subfig:antiferromagnet-phase}	
	}
	\hfil
	\subfloat[Polarized sublattices.]{
		\input{chapters/theoretical-introduction/pictures/antiferromagnet-sublattices}
		\label{subfig:antiferromagnet-sublattices}	
	}
	\caption{Schematic representation of the \AF phase. Fig.~\ref{subfig:antiferromagnet-phase} shows a portion of the square lattice with explicit representation of the spin for each site. Fig.~\ref{subfig:antiferromagnet-sublattices} divides the square lattice $\mathcal{S}$ in two polarized sublattices $\mathcal{S}_a$, $\mathcal{S}_b$. The AF phase results from the interaction of two inversely polarized ``ferromagnetic'' square lattices.}
	\label{fig:antiferromagnet-schemes}
\end{figure}

In this chapter the discussion is limited to the two-dimensional square lattice Hubbard model. The lattice considered has $L_\ell$ sites on side $\ell = x,y$, thus a total of $L_x L_y$ sites. The total number of single electron states is given by $D = 2L_x L_y$. All theoretical discussion neglects border effects, thus considering $D \to +\infty$.

\section{The Extended Fermi-Hubbard model}

The Extended Fermi-Hubbard model is defined by:
\begin{equation}\label{eq:extended-hubbard-model}
	\hat H =
	-t \sum_{\langle ij \rangle} \sum_\sigma \hat c_{i\sigma}^\dagger \hat c_{j\sigma}
	+ U \sum_i \hat n_{i\uparrow} \hat n_{i\downarrow}
	- V \sum_{\langle ij \rangle} \sum_{\sigma \sigma'} \hat n_{i\sigma} \hat n_{j\sigma'}
\end{equation}
Note that, on a square lattice, we can perform the summation over NN just as
\[
	\sum_{\ev{ij}} \equiv \sum_{i \in \mathcal{S}_a} \left[
		\delta_{j=i+\delta_x} + \delta_{j=i-\delta_x} + \delta_{j=i+\delta_y} + \delta_{j=i-\delta_y}
	\right]
\]
where notation of Fig.~\ref{subfig:antiferromagnet-sublattices} has been used. The last term represents an effective attraction between neighboring electrons, of amplitude $V$. Such an interaction is believed \cite{cao2025p-wave} necessary to describe the insurgence of high-$T_c$ superconductivity in cuprate SCs. \todo

\subsection{Experimental insight on NN attraction}

{\color{tabred}Todo:
\begin{itemize}
	\item High $T_c$ SC in cuprates;
	\item Experimental evidence of topological SC;
	\item Insertion of the non-local attraction;
\end{itemize}}

\section{Mean-Field theory description}

This section is devoted to develop a rough mean field approximation of the Extended Hubbard model of Eq.~\eqref{eq:extended-hubbard-model}. First part focuses on the non-local interaction $V$, expected to be source of superconductivity; the second part on the local interaction $U$, known to be source of Slater-like anti-ferromagnetism, as described in App.~\ref{appendix:mean-field-hubbard}.

\subsection{Mean-field treatment of the non-local term}

\begin{figure}
	\centering
	\input{chapters/theoretical-introduction/pictures/square-nearest-neighbors}
	\caption{Schematic representation of the four NNs of a given site $i$ for a planar square lattice.}
	\label{fig:square-nearest-neighbors}
\end{figure}

Consider the non-local term,
\begin{equation}\label{eq:extended-hubbard-nonlocal-interaction}
	\hat H_V \equiv - V \sum_{\langle ij \rangle} \sum_{\sigma \sigma'} \hat n_{i\sigma} \hat n_{j\sigma'}
\end{equation}
{\color{tabred}Since the relevant values for $V$ are $\mathcal{O}(t)$, in this model $V \ll U$.} Evidently the hamiltonian can be decomposed in various spin terms,
\[
\begin{aligned}
	\hat H_V &= \sum_{\sigma \sigma'} \hat H_V^{\sigma\sigma'} \\
	&= \underbrace{
		\hat H_V^{\uparrow\uparrow} + \hat H_V^{\downarrow\downarrow}
	}_\text{Ferromagnetic} + \underbrace{
		\hat H_V^{\uparrow\downarrow} + \hat H_V^{\downarrow\uparrow}
	}_\text{Anti-ferromagnetic}
\end{aligned}
\]
Evidently, to carry out a summation over nearest neighbors $\ev{ij}$ of a square lattice means precisely to sum over all links of the lattice. Then we can identify the generic AF term $\hat H_V^{\sigma \overline{\sigma}}$ as the one collecting the $\sigma$ operators of sublattice $\mathcal{S}_a$ and $\overline{\sigma}$ operators of sublattice $\mathcal{S}_b$. At half-filling, as described in Sec.~\ref{sec:antiferromagnetic-ordering-hubbard}, the ground-state leading contribution will be the antiferromagnetic state, with the square lattice decomposed in two oppositely polarized square lattices with spacing increased by a factor $\sqrt{2}$. Then, it is to be expected that on this configuration the ferromagnetic contributions are suppressed\footnote{
	This is also due to superexchange stabilization: the triplet contribution to hamiltonian is suppressed, and this cancels out the ferromagnetic terms $\hat H_V^{\sigma\sigma}$ while privileging the singlet configuration of the anti-ferromagnetic terms $\hat H_V^{\sigma\overline{\sigma}}$.
}. Anyways, the calculation will be carried out considering both terms.
The AF non-local interactions can be written as a sum of terms over just one of the two sublattices $\mathcal{S}_a$ and $\mathcal{S}_b$, oppositely polarized in the AF configuration (see Fig.~\ref{subfig:antiferromagnet-sublattices})
\[
	\begin{aligned}
		\hat H_V^{(\mathrm{AF})} &= \overbrace{
			\sum_{i \in \mathcal{S}_a} \hat h_V^{(i)}
		}^{\hat H_V^{\uparrow\downarrow}} + \overbrace{
			\sum_{i \in \mathcal{S}_b} \hat h_V^{(i)}
		}^{\hat H_V^{\downarrow\uparrow}} \\
		&= \sum_{i \in \mathcal{S}} \hat h_V^{(i)}
	\end{aligned}
	\hspace{0.1\textwidth}
	\hat h_V^{(i)} = -V \sum_{\ell = x,y} \left(
		\hat n_{i\uparrow} \hat n_{i + \delta_\ell \downarrow} + \hat n_{i\uparrow} \hat n_{i - \delta_\ell \downarrow} 
	\right) 
\]
Here the notation of Fig.~\ref{subfig:antiferromagnet-sublattices} is used. The two-dimensional lattice is regular-square. For each site $i$ in a given sublattice, the nearest neighbors sites are four -- all in the other sublattice. The notation used is $i \pm \delta_x$, $i \pm  \delta_y$ as in Fig.~\ref{fig:square-nearest-neighbors}. Similarly, the Ferromagnetic hamiltonian decomposes as
\[
	\hat H_V^{(\mathrm{F})} = -V \sum_{i \in \mathcal{S}_a} \sum_{\ell = x,y} \sum_\sigma \left(
		\hat n_{i\sigma} \hat n_{i + \delta_\ell \sigma} + \hat n_{i\sigma} \hat n_{i - \delta_\ell \sigma} 
	\right) 
\]
Note here the summation only on one sublattice. As will be shown in Sec.~\ref{subsec:mft-self-consitency-cooper-decomposition}, under MFT it makes sense to approximate
\[
	\hat H_V \simeq \hat{H}_V^{(\mathrm{AF})}
\]
thus neglecting ferromagnetic contribution to Cooper instability. The non-local interaction contribution to energy, as a function of the $T=0$ full hamiltonian ground-state\footnote{
	Extensions to finite temperatures is simple: minimization must be carried out on free energy, while expectation values must be taken in a thermodynamic fashion.
} $\ket{\Psi}$, is given by
\[
\begin{aligned}
	E_V [\Psi] &= \mel{\Psi}{\hat H_V}{\Psi} \\
	&= -V \sum_{i \in \mathcal{S}} \sum_{\ell = x,y} \langle
	\hat n_{i\uparrow} \hat n_{i + \delta_\ell \downarrow} + \hat n_{i\uparrow} \hat n_{i - \delta_\ell \downarrow}
	\rangle 
\end{aligned}
\]
Shorthand notation has been used: $\mel{\Psi}{\cdot}{\Psi} = \langle \cdot \rangle$. Consider one specific term, say, $\hat n_{i\uparrow} \hat n_{i + \delta_x \downarrow}$. Wick's Theorem states that, if the expectation value is performed onto a coherent state,
\[
\begin{aligned}
	\langle 
	\hat n_{i\uparrow} \hat n_{i + \delta_x \downarrow}
	\rangle &= \langle 
	\hat c_{i\uparrow}^\dagger \hat c_{i + \delta_x \downarrow}^\dagger \hat c_{i + \delta_x \downarrow} \hat c_{i\uparrow} 
	\rangle \\
	&= 
	\underbrace{
		\langle 
			\hat c_{i\uparrow}^\dagger \hat c_{i + \delta_x \downarrow}^\dagger
		\rangle \langle	
			\hat c_{i + \delta_x \downarrow} \hat c_{i\uparrow} 
		\rangle 
	}_{\text{Cooper}}
	- 
	\underbrace{
		\langle 
			\hat c_{i\uparrow}^\dagger \hat c_{i + \delta_x \downarrow}
		\rangle \langle	
			\hat c_{i + \delta_x \downarrow}^\dagger \hat c_{i\uparrow} 
		\rangle 
	}_{\text{Fock}}
	+ 
	\underbrace{
		\langle 
			\hat c_{i\uparrow}^\dagger \hat c_{i\uparrow}
		\rangle \langle	
			\hat c_{i + \delta_x \downarrow}^\dagger \hat c_{i + \delta_x \downarrow} 
		\rangle
	}_{\text{Hartree}}
\end{aligned}
\]
As a first approximation, the theorem is assumed to hold (which, in a $\mathrm{BCS}$-like fashion, is equivalent to assuming for the ground-state to be a coherent state). The last two terms account for single-particle interactions with a background field; they are relevant in the Hartree-Fock scheme, being direct-exchange contributions to single particle energies. The first term accounts for non-local electrons pairing, mimicking the Cooper term of $\mathrm{BCS}$ theory. The core assumption, here, is that only one of the HF and Bogoliubov pairings survive. Appendix \ref{appendix:mean-field-hubbard} shows a situation dominated by HF terms. Here, I assume the symmetry to be broken by a Cooper term. Energy then is cast to the form
\[
	E_V[\Psi] = -V \sum_{i \in \mathcal{S}} \sum_{\ell = x,y}
	\left[
		\langle
			\hat c_{i\uparrow}^\dagger \hat c_{i + \delta_\ell \downarrow}^\dagger
		\rangle \langle	
			\hat c_{i + \delta_\ell \downarrow} \hat c_{i\uparrow} 
		\rangle + \langle 
			\hat c_{i\uparrow}^\dagger \hat c_{i - \delta_\ell \downarrow}^\dagger
		\rangle \langle	
			\hat c_{i - \delta_\ell \downarrow} \hat c_{i\uparrow} 
		\rangle
	\right]
\]

The ground-state must realize the condition
\[
	\fdv{}{\bra{\Psi}} E[\Psi] = 0
\]
being $E[\Psi]$ the total energy (made up of the three terms of couplings $t$, $U$ and $V$). {\color{tabred}[Expand derivation?]} The functional derivative must be carried out in a variational fashion including a Lagrange multiplier, the latter accounting for state-norm conservation, as is done normally in deriving the Hartree-Fock approximation for the eigenenergies of the electron liquid \cite{grosso2014solid, giuliani2005quantum}. This approach leads to the conclusion that the (coherent) ground-state of the system must be an eigenstate of the mean-field effective hamiltonian:
\begin{equation}\label{eq:extended-hubbard-model-effective-intermediate}
	\begin{aligned}
		\hat H^{(\mathrm{e})} =
		&-t \sum_{\langle ij \rangle} \sum_\sigma \hat c_{i\sigma}^\dagger \hat c_{j\sigma}
		+ U \sum_{i \in \mathcal{S}} \hat n_{i\uparrow} \hat n_{i\downarrow} \\
		&- V \sum_{i \in \mathcal{S}} \sum_{\ell = x,y} \sum_{\delta = \pm \delta_\ell} \left[
			\langle 
				\hat c_{i\uparrow}^\dagger \hat c_{i + \delta \downarrow}^\dagger
			\rangle
			\hat c_{i + \delta \downarrow} \hat c_{i\uparrow} 
			+ \mathrm{h}.\mathrm{c}.
		\right]
	\end{aligned}
\end{equation}

The pairing correlation function is defined across each bond as the pairing expectation
\[
	g_{ij\sigma} \equiv \langle 
		\hat c_{i\sigma}^\dagger \hat c_{j \overline{\sigma}}^\dagger
	\rangle
\]
The effective hamiltonian reads:
\begin{equation}\label{eq:extended-hubbard-model-effective-intermediate-2}
	\hat H^{(\mathrm{e})} =
	-t \sum_{\langle ij \rangle} \sum_\sigma \hat c_{i\sigma}^\dagger \hat c_{j\sigma}
	+ U \sum_{i \in \mathcal{S}} \hat n_{i\uparrow} \hat n_{i\downarrow}
	- V \sum_{\langle ij \rangle} \sum_\sigma \left[
		g_{ij\sigma} \hat c_{j\overline{\sigma}} \hat c_{i\sigma} + g_{ij\sigma}^* \hat c_{i\sigma}^\dagger \hat c_{j\overline{\sigma}}^\dagger
	\right]
\end{equation}
As in standard $\mathrm{BCS}$ theory, this hamiltonian -- being quadratic in the electronic operators -- can be diagonalized via a Bogoliubov rotation. Superconducting pairing can arise both from the local $U$ term and from the non-local $V$ term. In next sections it is assumed the $V$ term generates dominant superconductivity via its weak non-local pairing.

\subsection{Mean-field treatment of the local term}

The mean-field description of the local (on-site) $U$ interaction is given in detail in App.~\ref{appendix:mean-field-hubbard}, along with a simple numerical analysis of the insurgence of antiferromagnetic ordering in a Hartree-Fock approximation scheme. Here the Cooper pairing is likewise assumed to dominate. Performing an analysis analogous to the one carried out in last section, we get the decoupling
\[
	U \sum_{i \in \mathcal{S}} \hat n_{i\uparrow} \hat n_{i\downarrow} \simeq \frac{U}{2} \sum_{i\sigma} \left[
		f_{i\sigma} \hat c_{i\overline{\sigma}} \hat c_{i\sigma} + f_{i\sigma}^* \hat c_{i\sigma}^\dagger \hat c_{i\overline{\sigma}}^\dagger
	\right]
\]
being
\[
	f_{i\sigma} \equiv \langle \hat c_{i\sigma}^\dagger \hat c_{i\overline{\sigma}}^\dagger \rangle
\]
Collect $f$ and $g$ in the unique function of two variables:
\[
	C_\sigma(i,j) = \begin{cases}
		f_{i\sigma} &\qq{if} i=j \\
		g_{ij\sigma} &\qq{if} \abs{i-j}=1 \\
		(\cdots) &\qq{otherwise}
	\end{cases}
\]
which expresses the generic correlator $\langle \hat c_{i\sigma}^\dagger \hat c_{j\overline{\sigma}}^\dagger \rangle$. The correlator for $\abs{i-j}>1$ is left unexpressed, and supposed to be subdominant. The decoupled hamiltonian, apart from pure energy shifts and suppressed terms, is given by
\begin{align}
	\hat H^{(\mathrm{e})} =
	-t \sum_{\langle ij \rangle} \sum_\sigma \hat c_{i\sigma}^\dagger \hat c_{j\sigma}
	&+ \frac{U}{2} \sum_{i\sigma} \left[
		f_{i\sigma} \hat c_{i\overline{\sigma}} \hat c_{i\sigma} + f_{i\sigma}^* \hat c_{i\sigma}^\dagger \hat c_{i\overline{\sigma}}^\dagger
	\right] \nonumber \\
	&- V \sum_{\langle ij \rangle} \sum_\sigma \left[
	g_{ij\sigma} \hat c_{j\overline{\sigma}} \hat c_{i\sigma} + g_{ij\sigma}^* \hat c_{i\sigma}^\dagger \hat c_{j\overline{\sigma}}^\dagger
	\right] \label{eq:extended-hubbard-model-effective}
\end{align}
The last form of the full hamiltonian contains explicitly spin DoF. The dissertation that follows includes explicitly spin DoF.

\subsection{Topological superconducting parameters over the square lattice}

\begin{figure}
	\centering
	\subfloat[Local $s$-wave]{
		\input{chapters/theoretical-introduction/pictures/s-wave-correlator}
		\label{subfig:s-wave-correlator}
	}
	\subfloat[Extended $s$-wave.]{
		\input{chapters/theoretical-introduction/pictures/s*-wave-correlator}
		\label{subfig:s*-wave-correlator}
	}\\[2em]
	\subfloat[$p_x$-wave.]{
		\input{chapters/theoretical-introduction/pictures/px-wave-correlator}
		\label{subfig:px-wave-correlator}
	}
	\subfloat[$p_y$-wave.]{
		\input{chapters/theoretical-introduction/pictures/py-wave-correlator}
		\label{subfig:py-wave-correlator}
	}
	\subfloat[$d_{x^2-y^2}$-wave.]{
		\input{chapters/theoretical-introduction/pictures/d-wave-correlator}
		\label{subfig:d-wave-correlator}
	}
	\caption{Different spatial structures of the correlation function under planar rotations. The figures show the first five local and NN contributions to the spatial structure of $C_\sigma(i,j)$. Each graph is a different contribution to the expansion of $C_\sigma$. Under each graph, each rim site contributes by a weight given by $\pm 1$ or $0$ times a constant dependent of the specific symmetry ($f$ or $g$ in figures), as specified in text.}
	\label{fig:wave-correlators}
\end{figure}

Consider Eq.~\eqref{eq:extended-hubbard-model-effective}, and for simplicity neglect the spin DoF in the last term. 

The correlator $g_{ij}$ is a function of position, specifically of its variables difference $r \equiv j-i$. Over the square lattice with NN interaction, the latter can assume four values: $\pm \delta_x$, $\pm \delta_y$. For a function of space defined over the four rim sites $i \pm \delta_\ell$ of Fig.~\ref{fig:square-nearest-neighbors}, various symmetry structures can be defined under the planar rotations group $\mathrm{SO}(2)$. In other words, the function $g_r$  can be decomposed in planar harmonics (which are simply the sine-cosine basis). Fig.~\ref{fig:wave-correlators} shows the first four spatial structures for the NN term. For each graph, the relative weight in the decomposition of $g_r$ is given by a constant correlation $g^{(\ell)}$ times a sum of signs and zeros as indicated in the various subgraphs of Fig.~\ref{fig:wave-correlators}. Tab.~\ref{tab:wave-correlators} reports said gap function contributions explicitly.

\begin{table}
	\centering
	\begin{tabular}{r E l l}
		\textbf{Structure} & \multicolumn{2}{c}{\textbf{Correlation function}} & \textbf{Graph} \\
		\midrule
		$s$-wave & $f^{(s)}_i$ & $f^{(s)}$ & Fig.~\ref{subfig:s-wave-correlator} \\
		Extended $s$-wave & $g^{(s)}_{ij}$ & $g^{(s)} \left(
		\delta_{j=i+\delta_x} + \delta_{j=i-\delta_x} + \delta_{j=i+\delta_y} + \delta_{j=i-\delta_y}
		\right)$ & Fig.~\ref{subfig:s*-wave-correlator} \\
		$p_x$-wave & $g^{(p_x)}_{ij}$ & $ g^{(p_x)} \left(
		\delta_{j=i+\delta_x} - \delta_{j=i-\delta_x}
		\right)$ & Fig.~\ref{subfig:px-wave-correlator} \\
		$p_y$-wave & $g^{(p_y)}_{ij}$ & $ g^{(p_y)} \left( \delta_{j=i+\delta_y} - \delta_{j=i-\delta_y}
		\right)$ & Fig.~\ref{subfig:py-wave-correlator} \\
		$d_{x^2-y^2}$-wave & $g^{(d_{x^2-y^2})}_{ij}$ & $ g^{(d_{x^2-y^2})} \left(
		\delta_{j=i+\delta_x} + \delta_{j=i-\delta_x} - \delta_{j=i+\delta_y} - \delta_{j=i-\delta_y}
		\right)$ & Fig.~\ref{subfig:d-wave-correlator} 
	\end{tabular}
	\caption{First four spatial structures for the correlation function $C(i,j)$ (spin DoF is neglected). In the middle column, all spatial dependence is included in the $\delta$s, while $f^{s}, g^{(\ell)} \in \mathbb{C}$. The last column indicates the graph representation of each contribution given in Fig.~\ref{fig:wave-correlators}.}
	\label{tab:wave-correlators}
\end{table}

SC is established with a given symmetry -- which means, symmetry breaking in the phase transition proceeds in a specific channel. Conventional $\mathrm{BCS}$ superconductivity arises from the only possible spatial structure of the local pairing, $s$-wave -- here appearing as a local term (Fig.~\ref{subfig:s-wave-correlator}) and extended on a non-local term (Fig.~\ref{subfig:s*-wave-correlator}). Cuprates exhibit a tendency towards $d_{x^2-y^2}$ SC, while other materials towards $p$-wave types -- eventually with some chirality, as is the case for $p_x \pm i p_y$ SCs.

In this $\mathrm{BCS}$-like approach, a self-consistent equation for the gap function must be retrieved in order to further investigate the model and extract the conditions for the formation of a superconducting phase with a given pairing topology.

\subsection{Reciprocal space transformation of hamiltonian}

Let me take a step back and perform explicitly the Fourier-transform of the various terms of Eq.~\ref{eq:extended-hubbard-model}. MFT will be implemented later.

\subsubsection*{Kinetic term}

The kinetic part is trivial to transform. Calculation is carried out in App.~\ref{app:mean-field-hubbard}. Let
\[
	\epsilon_\mathbf{k} \equiv -2t \left[
		\cos(k_x \delta_x) + \cos(k_y \delta_y)
	\right]
\]
then we have
\[
\begin{aligned}
	-t \sum_{\langle ij \rangle} \sum_\sigma \hat c_{i\sigma}^\dagger \hat c_{j\sigma} &= \sum_{\mathbf{k}\sigma} \epsilon_\mathbf{k} \hat c_{\mathbf{k}\sigma}^\dagger \hat c_{\mathbf{k}\sigma} \\
	&= \sum_\mathbf{k} \epsilon_\mathbf{k} \left[
		\hat c_{\mathbf{k}\uparrow}^\dagger \hat c_{\mathbf{k}\uparrow} + \hat c_{\mathbf{k}\downarrow}^\dagger \hat c_{\mathbf{k}\downarrow}
	\right] \\
	&= \sum_\mathbf{k} \epsilon_\mathbf{k} \left[
		\hat c_{\mathbf{k}\uparrow}^\dagger \hat c_{\mathbf{k}\uparrow}- \hat c_{-\mathbf{k}\downarrow} \hat c_{-\mathbf{k}\downarrow}^\dagger 
	\right]
\end{aligned}
\]
In last passage I used fermionic anti-commutation rules and reversed the sign of the mute variable. This will become useful later.

\subsubsection*{Non-local interaction}

Consider a generic bond, say, the one connecting sites $j$ and $j\pm\delta_\ell$ (variable $i$ is here referred to as the imaginary unit to avoid confusion). $\mathbf{x}_j$ is the $2$D notation for the position of site $j$, while $\bm{\delta}_\ell$ is the $2$D notation for the lattice spacing previously indicated as $\delta_\ell$. Fourier transform it according to the convention
\[
	\hat c_{j\sigma} = \frac{1}{\sqrt{L_xL_y}} \sum_{\mathbf{k} \in \mathrm{BZ}} e^{-i \mathbf{k} \cdot \mathbf{x}_j} \hat c_{\mathbf{k}\sigma}
\]
Then:
\[
\begin{aligned}
	\hat n_{j\uparrow} \hat n_{j \pm \delta_\ell \downarrow} &= \hat c_{j\uparrow}^\dagger \hat c_{j \pm \delta_\ell \downarrow}^\dagger \hat c_{j \pm \delta_\ell \downarrow} \hat c_{j\uparrow} \\
	&= \frac{1}{(L_xL_y)^2} \sum_{\nu=1}^4 \sum_{\mathbf{k}_\nu \in \mathrm{BZ}} e^{i \left[ (\mathbf{k}_1 + \mathbf{k}_2) - (\mathbf{k}_3 + \mathbf{k}_4) \right] \cdot \mathbf{x}_j} e^{\pm i(\mathbf{k}_2-\mathbf{k}_3) \cdot \bm{\delta}_\ell}  \hat c_{\mathbf{k}_1 \uparrow}^\dagger \hat c_{\mathbf{k}_2 \downarrow}^\dagger \hat c_{\mathbf{k}_3 \downarrow} \hat c_{\mathbf{k}_4\uparrow}
\end{aligned}
\]
It follows,
\[
\begin{aligned}
	\hat h_V^{(j)} &= -\frac{V}{(L_xL_y)^2} \sum_{\ell = x,y} \sum_{\nu=1}^4 \sum_{\mathbf{k}_\nu \in \mathrm{BZ}} e^{i \left[ (\mathbf{k}_1 + \mathbf{k}_2) - (\mathbf{k}_3 + \mathbf{k}_4) \right] \cdot \mathbf{x}_j} \\
	&\hspace{0.3\textwidth} \times \left(
		e^{ i(\mathbf{k}_2-\mathbf{k}_3) \cdot \bm{\delta}_\ell} + e^{ -i(\mathbf{k}_2-\mathbf{k}_3) \cdot \bm{\delta}_\ell} 
	\right)
	\hat c_{\mathbf{k}_1 \uparrow}^\dagger \hat c_{\mathbf{k}_2 \downarrow}^\dagger \hat c_{\mathbf{k}_3 \downarrow} \hat c_{\mathbf{k}_4\uparrow} \\
	&= -\frac{2V}{(L_xL_y)^2} \sum_{\ell = x,y} \sum_{\nu=1}^4 \sum_{\mathbf{k}_\nu \in \mathrm{BZ}} e^{i \left[ (\mathbf{k}_1 + \mathbf{k}_2) - (\mathbf{k}_3 + \mathbf{k}_4) \right] \cdot \mathbf{x}_j} \cos\left[
		(\mathbf{k}_2-\mathbf{k}_3) \cdot \bm{\delta}_\ell
	\right]	\hat c_{\mathbf{k}_1 \uparrow}^\dagger \hat c_{\mathbf{k}_2 \downarrow}^\dagger \hat c_{\mathbf{k}_3 \downarrow} \hat c_{\mathbf{k}_4\uparrow}
\end{aligned}
\]
The full non-local interaction is given by summing over all sites of $\mathcal{S}$. This gives back momentum conservation,
\[
	\frac{1}{L_xL_y} \sum_{j \in \mathcal{S}} e^{i \left[ (\mathbf{k}_1 + \mathbf{k}_2) - (\mathbf{k}_3 + \mathbf{k}_4) \right] \cdot \mathbf{x}_j} = \delta_{\mathbf{k}_1 + \mathbf{k}_2 = \mathbf{k}_3 + \mathbf{k}_4}
\]
Let $\mathbf{k}_1 + \mathbf{k}_2 = \mathbf{k}_3 + \mathbf{k}_4 = \mathbf{K}$, and define $\mathbf{k}$, $\mathbf{k}'$ such that
\[
	\mathbf{k}_1 \equiv \mathbf{K} + \mathbf{k} 
	\qquad
	\mathbf{k}_2 \equiv \mathbf{K} - \mathbf{k} 
	\qquad
	\mathbf{k}_3 \equiv \mathbf{K} - \mathbf{k}' 
	\qquad
	\mathbf{k}_4 \equiv \mathbf{K} + \mathbf{k}'
	\qquad
	\delta \mathbf{k} \equiv \mathbf{k}-\mathbf{k}'
\]
Sums over these variables must be intended as over the Brillouin Zone ($\mathrm{BZ}$). Then, finally
\[
\begin{aligned}
	\hat H_V &\simeq \sum_{j \in \mathcal{S}} \hat h_V^{(j)} \\
	&= - \frac{2V}{L_x L_y} \sum_{\ell = x,y} \sum_{\mathbf{K}, \mathbf{k}, \mathbf{k}'} \cos\left(
		\delta \mathbf{k} \cdot \bm{\delta}_\ell
	\right)	\hat c_{\mathbf{K}+\mathbf{k} \uparrow}^\dagger \hat c_{\mathbf{K}-\mathbf{k} \downarrow}^\dagger \hat c_{\mathbf{K}-\mathbf{k}' \downarrow} \hat c_{\mathbf{K}+\mathbf{k}'\uparrow} \\
%	&= -2V \sum_{\ell = x,y} \sum_{\mathbf{k}, \mathbf{k}'} \cos\left(
%		\delta \mathbf{k} \cdot \bm{\delta}_\ell
%	\right)	\hat c_{\mathbf{k} \uparrow}^\dagger \hat c_{-\mathbf{k} \downarrow}^\dagger \hat c_{-\mathbf{k}' \downarrow} \hat c_{\mathbf{k}' \uparrow} \\
%	&= -2V \sum_{\mathbf{k}, \mathbf{k}'}
%	\left[
%		\cos \left(
%			\delta k_x \delta_x
%		\right)	+ \cos \left(
%			\delta k_y \delta_y
%		\right)	
%	\right] \hat c_{\mathbf{k} \uparrow}^\dagger \hat c_{-\mathbf{k} \downarrow}^\dagger \hat c_{-\mathbf{k}' \downarrow} \hat c_{\mathbf{k}' \uparrow}
	&= - \frac{2V}{L_x L_y} \sum_{\ell = x,y} \sum_{\mathbf{K}, \mathbf{k}, \mathbf{k}'} \left[
		\cos \left(
			\delta k_x \delta_x
		\right)	+ \cos \left(
			\delta k_y \delta_y
		\right)	
	\right]	\hat c_{\mathbf{K}+\mathbf{k} \uparrow}^\dagger \hat c_{\mathbf{K}-\mathbf{k} \downarrow}^\dagger \hat c_{\mathbf{K}-\mathbf{k}' \downarrow} \hat c_{\mathbf{K}+\mathbf{k}'\uparrow} \\
\end{aligned}
\]
Eventually, in the second passage the prefactor $2$ can be absorbed by reintroducing the spin DoF\footnote{
	Justification can be given in two ways: either commutating appropriately the $\hat c$ operators, or by carrying out the previous space sums independently over the two sublattices.
}. Taking in the mean-field approximation (with Cooper pair symmetry breaking), we get
\[
	\hat c_{\mathbf{K}+\mathbf{k} \uparrow}^\dagger \hat c_{\mathbf{K}-\mathbf{k} \downarrow}^\dagger \hat c_{\mathbf{K}-\mathbf{k}' \downarrow} \hat c_{\mathbf{K}+\mathbf{k}'\uparrow} \simeq \langle
		\hat c_{\mathbf{K}+\mathbf{k} \uparrow}^\dagger \hat c_{\mathbf{K}-\mathbf{k} \downarrow}^\dagger
	\rangle \hat c_{\mathbf{K}-\mathbf{k}' \downarrow} \hat c_{\mathbf{K}+\mathbf{k}'\uparrow} + \hat c_{\mathbf{K}+\mathbf{k} \uparrow}^\dagger \hat c_{\mathbf{K}-\mathbf{k} \downarrow}^\dagger \langle 
		\hat c_{\mathbf{K}-\mathbf{k}' \downarrow} \hat c_{\mathbf{K}+\mathbf{k}'\uparrow}
	\rangle + \cdots
\]
Take e.g. $\langle \hat c_{\mathbf{K}+\mathbf{k} \uparrow}^\dagger \hat c_{\mathbf{K}-\mathbf{k} \downarrow}^\dagger \rangle$: the only non-zero contribution can come from the $\mathbf{K}=\mathbf{0}$ term, as will be discussed self-consistently in Sec.~\ref{subsec:mft-self-consitency-cooper-decomposition}. Then finally:
\[
\begin{aligned}
	\hat H_V \simeq - \frac{2V}{L_x L_y}\sum_{\mathbf{k}, \mathbf{k}'}
	\left[
		\cos \left(
			\delta k_x \delta_x
		\right)	+ \cos \left(
			\delta k_y \delta_y
		\right)	
	\right] \left[
		\langle 
			\hat c_{\mathbf{k}\uparrow}^\dagger \hat c_{-\mathbf{k} \downarrow}^\dagger
		\rangle \hat \phi_{\mathbf{k}'} + \langle 
			\hat c_{-\mathbf{k}\downarrow} \hat c_{\mathbf{k} \uparrow}
		\rangle \hat \phi_{\mathbf{k}'}^\dagger
	\right]	
\end{aligned}
\]
having I defined the pairing operator 
\[
	\hat \phi_\mathbf{k} \equiv \hat c_{-\mathbf{k}\downarrow} \hat c_{\mathbf{k} \uparrow}
\]
Defining appropriately the non-local gap function,
\begin{equation}\label{eq:gap-function-definition}
	\mathcal{V}_\mathbf{k} \equiv \frac{2V}{L_x L_y} \sum_{\mathbf{k}'} \left[
		\cos \left(
			\vphantom{A^A}
			(k_x-k_x') \delta_x
		\right)	+ \cos \left(
			\vphantom{A^A}
			(k_y-k_y') \delta_y
		\right)	
	\right] \langle 
		\hat c_{\mathbf{k}'\uparrow}^\dagger \hat c_{-\mathbf{k}' \downarrow}^\dagger
	\rangle
\end{equation}
one gets immediately
\begin{equation}\label{eq:extended-hubbard-nonlocal-interaction-mean-field-reciprocal}
	\hat H_V \simeq - \sum_\mathbf{k} \left[
		\mathcal{V}_\mathbf{k} \hat \phi_\mathbf{k} + \mathcal{V}_\mathbf{k}^* \hat \phi_\mathbf{k}^\dagger
	\right]	
\end{equation}
The non-local interaction has been reduced, by MFT, to particle-background interaction for the $\phi$-fermions.

\subsubsection*{Local interaction}

A very similar argument can be carried out for the local $U$ term. Without delving in too many details, the local gap $\mathcal{U}_\mathbf{k}$ is given by
\begin{equation}\label{eq:sgap-function-definition}
	\mathcal{U}_\mathbf{k} \equiv \frac{U}{2 L_x L_y} \sum_{\mathbf{k}'} \langle 
	\hat c_{\mathbf{k}'\uparrow}^\dagger \hat c_{-\mathbf{k}' \downarrow}^\dagger
	\rangle
\end{equation}
evidently independent of $\mathbf{k}$, correctly. The local part of the hamiltonian then gets
\begin{equation}\label{eq:extended-hubbard-local-interaction-mean-field-reciprocal}
	\hat H_U = \sum_\mathbf{k} \left[
		\mathcal{U}_\mathbf{k} \hat \phi_\mathbf{k} + \mathcal{U}_\mathbf{k}^* \hat \phi_\mathbf{k}^\dagger
	\right]	
\end{equation}
The total gap is thus given by the simple difference of non-local and local parts,
\[
	\Delta_\mathbf{k} \equiv \mathcal{V}_\mathbf{k} - \mathcal{U}_\mathbf{k}
\]
Within this structure, we are finally able to move to Nambu formalism.

\subsection{Nambu formalism and Bogoliubov transform}\label{subsec:nambu-formalism-mean-field-extended-hubbard}

Define the Nambu spinor\footnote{
	Notice that the spinor is here differently defined with respect to App.~\ref{appendix:mean-field-hubbard}, where because of the HF prevalence in mean-field decoupling the spinor components were homogeneously fermions creations or destructions.
} as in BCS
\[
	\hat \Psi_\mathbf{k} \equiv \begin{bmatrix}
		\hat c_{\mathbf{k}\uparrow} \\
		\hat c_{-\mathbf{k}\downarrow}^\dagger
	\end{bmatrix}
\]
Evidently,
\begin{equation}\label{eq:extended-hubbard-phi-psi-expressions}
	\phi_\mathbf{k} = \hat \Psi_\mathbf{k}^\dagger \begin{bmatrix}
		0 & 1 \\ 0 & 0
	\end{bmatrix} \hat \Psi_\mathbf{k}
	\qquad
	\phi_\mathbf{k}^\dagger = \hat \Psi_\mathbf{k}^\dagger \begin{bmatrix}
		0 & 0 \\ 1 & 0
	\end{bmatrix} \hat \Psi_\mathbf{k}
\end{equation}
The full hamiltonian is then given by:
\begin{equation}\label{eq:extended-hubbard-hamiltonian-nambu-bogoliubov}
	\hat H = \sum_\mathbf{k} \hat \Psi_\mathbf{k} h_\mathbf{k} \hat \Psi_\mathbf{k}
	\qquad
	h_\mathbf{k} \equiv \begin{bmatrix}
		\epsilon_\mathbf{k} & - \Delta_\mathbf{k}^* \\
		- \Delta_\mathbf{k} & - \epsilon_\mathbf{k}
	\end{bmatrix}
\end{equation}
Let $\tau^\alpha$ for $\alpha = x,y,z$ be the Pauli matrices. Define:
\[
	\hat s_\mathbf{k}^\alpha \equiv \hat \Psi_\mathbf{k}^\dagger \tau^\alpha \hat \Psi_\mathbf{k}
	\qq{for}
	\alpha = x,y,z
\]
As can be shown easily, these operators realize spin-$1/2$ algebra. $\hat H$ represents an ensemble of $L_x L_y$ independent spins subject to pseudo-magnetic fields. Note that, differently form App.~\ref{app:mean-field-hubbard} where the chemical potential is inserted later (because in Nambu formalism it accounts for a diagonal term) here the chemical potential is part of the $z$ component of the pseudo-magnetic field, since
\begin{align}
	\hat n_{\mathbf{k}\uparrow} + \hat n_{-\mathbf{k}\downarrow} &= \hat c_{\mathbf{k}\uparrow}^\dagger \hat c_{\mathbf{k}\uparrow} + \hat c_{-\mathbf{k}\downarrow}^\dagger \hat c_{-\mathbf{k}\downarrow} \nonumber \\
	&= \hat c_{\mathbf{k}\uparrow}^\dagger \hat c_{\mathbf{k}\uparrow} - \hat c_{-\mathbf{k}\downarrow} \hat c_{-\mathbf{k}\downarrow}^\dagger + \mathbb{I} \nonumber \\
	&=  \hat \Psi_\mathbf{k}^\dagger \tau^z \hat \Psi_\mathbf{k} + \mathbb{I} \label{eq:number-operator-z-spin-relation}
\end{align}
and then it follows
\[
\begin{aligned}
	-\mu\hat N &= -\mu \sum_{\mathbf{k} \in \mathrm{BZ}} \left[ \hat n_{\mathbf{k}\uparrow} + \hat n_{-\mathbf{k}\downarrow} \right] \\
	&= -\mu \sum_{\mathbf{k} \in \mathrm{BZ}} \hat \Psi_\mathbf{k}^\dagger \tau^z \hat \Psi_\mathbf{k} -\mu L_x L_y
\end{aligned}
\]
Then, adding a term $-\mu \hat N$ to $\hat H$, apart from an irrelevant total energy increase, changes the pseudo-field whose explicit form becomes
\begin{equation} \label{eq:extended-hubbard-pseudo-magnetic-field}
	\mathbf{b}_\mathbf{k} \equiv \begin{bmatrix}
		-\Re{\Delta_\mathbf{k}} \\
		-\Im{\Delta_\mathbf{k}} \\ \epsilon_\mathbf{k} - \mu
	\end{bmatrix}
\end{equation}
This hamiltonian behaves as an ensemble of spins in local magnetic fields precisely as in Eq.~\eqref{appeq:hubbard-bogoliubov-hamiltonian-pseudofields},
\begin{equation}\label{eq:extended-hubbard-bogoliubov-hamiltonian-pseudofields}
	\hat H -\mu \hat N = \sum_{\mathbf{k} \in \mathrm{BZ}} \mathbf{b}_\mathbf{k} \cdot \hat{\mathbf{s}}_\mathbf{k}
	\qq{where}
	\hat{\mathbf{s}}_{\mathbf{k}\sigma} = \begin{bmatrix}
		\hat s_\mathbf{k}^x \\
		\hat s_\mathbf{k}^y \\
		\hat s_\mathbf{k}^z
	\end{bmatrix}
\end{equation}
Proceed as in App.~\ref{app:mean-field-hubbard} and diagonalize via a rotation,
\[
	d_\mathbf{k} \equiv \begin{bmatrix}
		-E_\mathbf{k} & \\ & E_\mathbf{k}
	\end{bmatrix}
	\qq{being}
	E_\mathbf{k} \equiv \sqrt{(\epsilon_\mathbf{k}-\mu)^2 + \abs{\Delta_\mathbf{k}}^2}
\]
An HF algorithm requires iterative update of the order parameter. The general strategy here is to try different symmetry breaking structures via a set of self-consistency equations. From Eqns.~\eqref{eq:gap-function-definition}, \eqref{eq:sgap-function-definition} we have formulas to calculate $\Delta_\mathbf{k}$ and $\mathcal{U}_\mathbf{k}$. Given the pseudoangles
\[
	\tan(2\theta_\mathbf{k}) \equiv \frac{\abs{\Delta_\mathbf{k}}}{\epsilon_\mathbf{k}}
	\qquad
	\tan(2\varphi_\mathbf{k}) \equiv \frac{\Im{\Delta_\mathbf{k}}}{\Re{\Delta_\mathbf{k}}}
\]
the general diagonalizer will be an orthogonal rotation matrix
\begin{align}
	W_\mathbf{k} &= e^{i \left(\theta_\mathbf{k} - \frac{\pi}{2}\right) \tau^y} e^{i \varphi_\mathbf{k} \tau^z} \nonumber \\
	&= \begin{bmatrix}
		-\sin\theta_\mathbf{k}  & -\cos\theta_\mathbf{k}  \\ 
		\cos\theta_\mathbf{k}  & -\sin\theta_\mathbf{k} 
	\end{bmatrix} \begin{bmatrix}
		e^{i\varphi_\mathbf{k} } & \\ & e^{-i\varphi_\mathbf{k} }
	\end{bmatrix} \nonumber \\
	&= \begin{bmatrix}
		-\sin\theta_\mathbf{k}  e^{i\varphi_\mathbf{k} } & -\cos\theta_\mathbf{k}  e^{-i\varphi_\mathbf{k} }  \\ 
		\cos\theta_\mathbf{k}  e^{i\varphi_\mathbf{k} } & -\sin\theta_\mathbf{k}  e^{-i\varphi_\mathbf{k} } 
	\end{bmatrix} \label{eq:extended-hubbard-bogoliubov-W-diagonalizer-explicit}
\end{align}
given by a rotation of angle $\varphi_\mathbf{k}$ around the $z$ axis, to align the $x$ axis with the field projection onto the $xy$ plane, followed by a rotation around the $y$ axis to anti-align with the pseudo-field. The diagonalization operators are given by
\[
	\hat\Phi_\mathbf{k} \equiv W_\mathbf{k} \hat\Psi_\mathbf{k}
\]
then, using Eq.~\eqref{appeq:finite-temperature-order-parameter-derivation-intermediate}, 
\[
	\left\langle [\hat \Psi_\mathbf{k}^\dagger]_i [\hat \Psi_\mathbf{k}]_j \right\rangle = [W_\mathbf{k}]_{1 i} [W_\mathbf{k}^\dagger]_{j 1} f\left( -E_\mathbf{k}; \beta,0 \right) + [W_\mathbf{k}]_{2 i} [W_\mathbf{k}^\dagger]_{j 2} f\left( E_\mathbf{k}; \beta,0 \right)
\]
where in the Fermi-Dirac function chemical potential was set to zero, because it already was included in the diagonalized hamiltonian.
Recalling Eq.~\eqref{eq:extended-hubbard-phi-psi-expressions}, it follows
\begin{align}
	\langle \phi_\mathbf{k} \rangle &= [W_\mathbf{k}]_{12} [W_\mathbf{k}^\dagger]_{11} f\left( -E_\mathbf{k}; \beta,0 \right) + [W_\mathbf{k}]_{22} [W_\mathbf{k}^\dagger]_{12} f\left( E_\mathbf{k}; \beta,0 \right) \label{eq:pairing-expectation} \\
	\langle \phi_\mathbf{k}^\dagger \rangle &= [W_\mathbf{k}]_{11} [W_\mathbf{k}^\dagger]_{21} f\left( -E_\mathbf{k}; \beta,0 \right) + [W_\mathbf{k}]_{21} [W_\mathbf{k}^\dagger]_{22} f\left( E_\mathbf{k}; \beta,0 \right) \label{eq:pairing-dagger-expectation}
\end{align}
These equations give us the formulas to compute the order parameters in the HF approach, directly by their definitions of Eqns.~\eqref{eq:gap-function-definition}, \eqref{eq:sgap-function-definition}. At each point in $k$-space $(k_x,k_y)$, the matrix $h_\mathbf{k}$ is diagonalized and the diagonalizer entries $[W_\mathbf{k}]_{ij}$ are combined in this fashion to recover the pairing expectation. The $z$ component of the spin operators is related to density: using Eq.~\eqref{appeq:finite-temperature-order-parameter-derivation-intermediate},
\[
	\langle \hat\Psi_\mathbf{k}^\dagger \tau^z \hat\Psi_\mathbf{k} \rangle = \left\langle [\hat \Psi_\mathbf{k}^\dagger]_1 [\hat \Psi_\mathbf{k}]_1 \right\rangle - \left\langle [\hat \Psi_\mathbf{k}^\dagger]_2 [\hat \Psi_\mathbf{k}]_2 \right\rangle
\]
we get, from Eq.~\eqref{eq:number-operator-z-spin-relation},
\begin{align}
	\langle \hat n_{\mathbf{k}\uparrow} \rangle + \langle \hat 	n_{-\mathbf{k}\downarrow} \rangle = 1 &+ \langle \hat\Psi_\mathbf{k}^\dagger \tau^z \hat\Psi_\mathbf{k} \rangle \nonumber \\
	= 1 &+ \left(
		\abs{[W_\mathbf{k}]_{11}}^2 - \abs{[W_\mathbf{k}]_{12}}^2
	\right) f\left( -E_\mathbf{k}; \beta,0 \right) \nonumber \\
	&+ \left(
		\abs{[W_\mathbf{k}]_{21}}^2 - \abs{[W_\mathbf{k}]_{22}}^2
	\right) f\left( E_\mathbf{k}; \beta,0 \right) \nonumber \\
	= 1 &- \cos \left(2 \theta_\mathbf{k}\right) \tanh(\frac{\beta E_\mathbf{k}}{2}) \label{eq:density-expectation} 
\end{align}
the last passage obtained by computing the matrix element from the explicit form of $W_\mathbf{k}$ of Eq.~\eqref{eq:extended-hubbard-bogoliubov-W-diagonalizer-explicit} and by the simple relation
\[
\begin{aligned}
	\frac{1}{e^{-x}+1} - \frac{1}{e^x+1} &= \frac{e^x -1}{e^x +1} \\
	&= \tanh(\frac{x}{2})
\end{aligned}
\]
The expectation value for the density is needed in order to extract the optimal chemical potential $\mu$ for the target density we aim to simulate at the given parametrization.

\subsection{A short comment on self-consistency}\label{subsec:mft-self-consitency-cooper-decomposition}

The Bogoliubov fermions in spinor representation satisfy obviously $\hat \Psi_\mathbf{k} = W_\mathbf{k}^\dagger \hat \Phi_\mathbf{k}$. Consider e.g.
\[
	\langle
		\hat c_{\mathbf{k}\sigma}^\dagger
		\hat c_{-\mathbf{k}\sigma}^\dagger
	\rangle	
\]
which is a spin-symmetric anomalous Cooper pair. For simplicity, take $\sigma=\uparrow$. Expand:
\[
\begin{aligned}
	\langle
		\hat c_{\mathbf{k}\uparrow}^\dagger
		\hat c_{-\mathbf{k}\uparrow}^\dagger
	\rangle	&= \left\langle 
		[\hat \Psi_\mathbf{k}^\dagger]_1 [\hat \Psi_{-\mathbf{k}}^\dagger]_1 
	\right\rangle \\
	&= \left\langle 
		[W_\mathbf{k} \hat \Phi_\mathbf{k}^\dagger]_1 [W_{-\mathbf{k}} \hat \Phi_{-\mathbf{k}}^\dagger]_1 
	\right\rangle
\end{aligned}
\]
This expectation value is taken over the ground-state, the latter being the vacuum of $\Phi$ fermions. Evidently the above expectation cannot assume non-zero values. Obviously the same holds for $\sigma=\downarrow$, and this argument explains why the Ferromagnetic terms of the hamiltonian decomposition do not contribute to Cooper instability. An identical argument, with the exchange
\[
	(\sigma,\sigma) \to (\uparrow,\downarrow)
	\qq{and}
	(\mathbf{k},-\mathbf{k}) \to (\mathbf{K}+\mathbf{k},\mathbf{K}-\mathbf{k})
	\qq{with}
	\mathbf{K}\neq\mathbf{0}
\]
justifies why in Sec.~\ref{subsec:nambu-formalism-mean-field-extended-hubbard} the only relevant contribution was given by $\mathbf{K}=\mathbf{0}$.

\subsection{Non-local gap structures}

Let's have a closer look to Eq.~\eqref{eq:gap-function-definition}: performing explicitly
\[
\begin{aligned}
	\langle 
		\hat c_{\mathbf{k}\sigma}^\dagger \hat c_{-\mathbf{k} \overline{\sigma}}^\dagger
	\rangle &= \frac{1}{L_x L_y} \sum_{ij} e^{i \mathbf{k} \cdot (\mathbf{x}_i - \mathbf{x}_j)} C_\sigma(i,j) \\
	&= \frac{1}{L_x L_y} \sum_{i \in \mathcal{S}} f_{i\sigma} + \frac{1}{L_x L_y} \sum_{\ev{ij}} e^{i \mathbf{k} \cdot (\mathbf{x}_i - \mathbf{x}_j)} g_{ij\sigma} + (\text{subdominant})
\end{aligned}
\]
Contributions to $C_\sigma(i,j)$ from $\abs{i-j}>1$ are assumed to be subdominant and then neglected. The above equation needs to be equipped with some structure for $f_{i\sigma}$ and $g_{ij\sigma}$. The main idea is to try different channels of symmetry breaking starting from the gap function structures of Tab.~\ref{tab:wave-correlators} and follow the general HF procedure sketched in detail in App.~\ref{appendix:mean-field-hubbard}. An iterative algorithm will be carried out to estimate, rather roughly, the creation of an instability towards a precise topological superconducting pairing. Before doing so, notice that $g_{ij\sigma}$ is actually a function of $r = j-i$ (in vectorial notation: $\bm{\delta}_\ell = \mathbf{x}_j - \mathbf{x}_i$, with $\ell \in \lbrace x,y \rbrace$) in the symmetries we are considering, listed in Tab.~\ref{tab:wave-correlators}. Thus
\begin{equation}\label{eq:correlation-fourier}
	\langle 
		\hat c_{\mathbf{k}\sigma}^\dagger \hat c_{-\mathbf{k} \overline{\sigma}}^\dagger
	\rangle = f^{(s)} + \sum_{\ell = x,y} \left[
		e^{i \mathbf{k} \cdot \bm{\delta_\ell}} g_{\bm{\delta}_\ell\sigma} + e^{- i \mathbf{k} \cdot \bm{\delta_\ell}} g_{-\bm{\delta}_\ell\sigma}
	\right]
\end{equation}
Here, the simple uniform Ansatz for the $f$ term has been included. By using the simple structures of Fig.~\ref{fig:wave-correlators} for the $g$ function, this expression simplifies a lot. Moreover, considering the terms of Eq.~\eqref{eq:gap-function-definition},
\begin{multline*}
	\cos \left( \delta k_x \delta_x \right)	+ \cos \left( \delta k_y \delta_y \right) = \cos \left( k_x \delta_x \right) \cos \left( k_x' \delta_x \right) + \sin \left( k_x \delta_x \right) \sin \left( k_x' \delta_x \right) \\ 
	+ \cos \left( k_y \delta_y \right) \cos \left( k_y' \delta_y \right) + \sin \left( k_y \delta_y \right) \sin \left( k_y' \delta_y \right)
\end{multline*}
For the sake of readability, the notations
\[
	c_\ell \equiv \cos\left(k_\ell \delta_\ell \right)
	\qquad
	s_\ell \equiv \sin \left(k_\ell \delta_\ell \right)
	\qquad
	c_\ell' \equiv \cos\left(k_\ell' \delta_\ell \right)
	\qquad
	s_\ell' \equiv \sin \left(k_\ell' \delta_\ell \right)
\]
are used. Group the four terms above,
\begin{equation}\label{eq:sym-asym-couplings-gap}
	\underbrace{
		\left(c_x c_x' + c_y c_y' \right) 
	}_\text{Symmetric}
	+ \underbrace{
		\left(s_x s_x' + s_y s_y' \right)
	}_\text{Anti-symmetric}
\end{equation}
Since sums on $\mathbf{k}$, $\mathbf{k}'$ are carried out, based on the specific $g_\mathbf{k}$ symmetry structures one can eliminate one of the two contributions. Take e.g. the $p_x$ gap structure of Fig.~\ref{subfig:px-wave-correlator}, listed in Tab.~\ref{tab:wave-correlators}: since it exhibits spatial anti-symmetry on the $x$ direction and (trivial) symmetry on the $y$ direction, of the above terms only the $x$ anti-symmetric part will contribute -- which is, $s_x s_x'$. This property becomes useful in the next paragraphs, where detailed derivations on the spatial structures of the gap function are carried out. Results are listed in Tat.~\ref{tab:wave-gaps}.

\begin{table}
	\centering
	\begin{tabular}{r E l l}
		\textbf{Structure} & \multicolumn{2}{c}{\textbf{Gap function}} & \textbf{Graph} \\
		\midrule
		$s$-wave & $\mathcal{U}_\mathbf{k}$ & $\mathcal{U}^{(s)}$ & Fig.~\ref{subfig:s-wave-correlator} \\
		Extended $s$-wave & $\mathcal{V}_\mathbf{k}^{(s)}$ & $\mathcal{V}^{(s)} \left[
			\cos(k_x) + \cos(k_y)
		\right]$ & Fig.~\ref{subfig:s*-wave-correlator} \\
		$p_x$-wave & $\mathcal{V}_\mathbf{k}^{(p_x)}$ & $ i\mathcal{V}^{(p_x)} \sin(k_x) $ & Fig.~\ref{subfig:px-wave-correlator} \\
		$p_y$-wave & $\mathcal{V}_\mathbf{k}^{(p_y)}$ & $ i\mathcal{V}^{(p_y)} \sin(k_y) $ & Fig.~\ref{subfig:py-wave-correlator} \\
		$d_{x^2-y^2}$-wave & $\mathcal{V}_\mathbf{k}^{(d)}$ & $\mathcal{V}^{(d)} \left[
			\cos(k_x) - \cos(k_y)
		\right]$ & Fig.~\ref{subfig:d-wave-correlator}
	\end{tabular}
	\caption{Gap structures for the four spatial symmetries of Fig.~\ref{fig:wave-correlators}.}
	\label{tab:wave-gaps}
\end{table}

\subsubsection*{Extended $s$-wave gap structure}\label{subsubsec:swave-gap-structure}

The standard $s$-wave structure of the gap function in BCS theory is given by the local interaction of Fig.~\ref{subfig:s-wave-correlator}. Consider also its NN extension of Fig.~\ref{subfig:s*-wave-correlator}, we will refer to also as ``$s^*$-wave''. It is completely symmetric under rotations and inversions, thus it couples trivially to the symmetric part of the decoupling \eqref{eq:sym-asym-couplings-gap}. Eq.~\eqref{eq:correlation-fourier} becomes:
\[
	\langle 
	\hat c_{\mathbf{k}\sigma}^\dagger \hat c_{-\mathbf{k} \overline{\sigma}}^\dagger
	\rangle = f^{(s)} + 2g^{(s)} (c_x + c_y)
\]
Performing the computation of Eq.~\eqref{eq:gap-function-definition} within this approximation, we get:
\[
\begin{aligned}
	\mathcal{V}_\mathbf{k}^{(s)} &= \frac{2V}{L_x L_y} \sum_{\mathbf{k}'} (c_x c_x' + c_y c_y') \left[
		f^{(s)} + 2g^{(s)}(c_x' + c_y')
	\right] \\
	\mathcal{U}_\mathbf{k}^{(s)} &= \frac{U}{2L_x L_y} \sum_{\mathbf{k}'} \left[
		f^{(s)} + 2g^{(s)}(c_x' + c_y')
	\right]
\end{aligned}
\]
Evidently $\sum_{\mathbf{k}'} c_\ell' = 0$. Then in the expression for $\mathcal{V}_\mathbf{k}^{(s)}$ the $f$ part is suppressed, and likewise is the $g$ part in the $\mathcal{U}_\mathbf{k}^{(s)}$ equation. Take a continuum approximation,
\[
\begin{aligned}
	\frac{1}{L_x L _y}\sum_{\mathbf{k}'} c_\ell (c_\ell')^2 &\simeq c_\ell \int_{-\pi}^\pi \frac{ds}{2\pi} \cos^2 s = \frac{c_\ell}{2} \\
	\frac{1}{L_x L _y}\sum_{\mathbf{k}'} c_\ell (c_\ell' c_{\overline{\ell}}') &\simeq c_\ell \left[ \int_{-\pi}^\pi \frac{ds}{2\pi} \cos s \right]^2 = 0
\end{aligned}
\]
It follows:
\begin{equation}\label{eq:swave-gap}
	\mathcal{V}_\mathbf{k}^{(s)} = \mathcal{V}^{(s)} (c_x + c_y)
	\qquad
	\mathcal{U}_\mathbf{k}^{(s)} = \mathcal{U}^{(s)}
\end{equation}
where $\mathcal{V}^{(s)} \equiv V \times 2g^{(s)}$ and $\mathcal{U}^{(s)} \equiv U \times f^{(s)}/2$. The quantity $\mathcal{V}^{(s)}$ is the order parameter in our HF scheme.

\subsubsection{$p_\ell$-wave gap structure}

Take $\ell \in \lbrace x,y \rbrace$ and consider the $p_\ell$-wave correlation in Tab.~\ref{tab:wave-correlators}. Due to its anti-symmetry, it couples only to the antisymmetric part of \eqref{eq:sym-asym-couplings-gap}. From Eq.~\eqref{eq:correlation-fourier},
\[
	\langle 
		\hat c_{\mathbf{k}\sigma}^\dagger \hat c_{-\mathbf{k} \overline{\sigma}}^\dagger
	\rangle = 2i g^{(p_\ell)} s_\ell
\]
and then from Eq.~\eqref{eq:gap-function-definition}
\[
	\mathcal{V}_\mathbf{k}^{(p_\ell)} = 2i g^{(p_\ell)} \frac{2V}{L_xL_y}\sum_{\mathbf{k}'} (s_x s_x' + s_y s_y') s_\ell'
\]
Using identical reasoning as above,
\[
	\mathcal{V}_\mathbf{k}^{(p_\ell)} = i \mathcal{V}^{(p_\ell)} s_\ell
\]
where $\mathcal{V}^{(p_\ell)} \equiv V \times 2 g^{(p_\ell)}$.

\subsubsection{$d$-wave gap structure}

Consider a $d_{x^2 - y^2}$-wave structured gap function as in Fig.~\ref{subfig:d-wave-correlator} The discourse here is perfectly analogous to Sec.~\ref{subsubsec:swave-gap-structure}, with the only difference
\[
	c_x + c_y
	\quad\to\quad
	c_x - c_y
\]
Then the $d$-wave gap has the structure
\begin{equation}\label{eq:dwave-gap}
	\mathcal{V}_\mathbf{k}^{(d)} = \mathcal{V}^{(d)} (c_x - c_y)
\end{equation}
where $\mathcal{V}^{(d)} \equiv V \times 2 g^{(d)}$. Subscript $x^2 - y^2$ has been omitted for reasons of clarity.

\subsection{Algorithmic reconstruction of the gap topology}

{\color{tabred}[This section was included to account for a multi-symmetry gap function search algorithm.]}

Proceeding as in Sec.~\ref{subsec:nambu-formalism-mean-field-extended-hubbard}, at each step we are able to recover $\mathcal{U}_\mathbf{k}$ and $\mathcal{V}_\mathbf{k}$. Indeed, simply diagonalizing $h_\mathbf{k}$ and using Eq.~\eqref{eq:pairing-dagger-expectation} we recover $\langle \hat \phi_\mathbf{k} \rangle$; then, by reconstruction, we use Eqns.~\eqref{eq:gap-function-definition} and \eqref{eq:sgap-function-definition} to get $\mathcal{U}_\mathbf{k}$ and $\mathcal{V}_\mathbf{k}$. Last step is to distinguish different topologies. From Tab.~\ref{tab:wave-gaps}, we see
\[
	\Gamma_\mathbf{k} = \Gamma^{(\ell)} f_\ell (\mathbf{k})
	\qquad
	\Gamma = \Sigma, \Delta
	\qquad
	\ell = s,p_x,p_y,d_{x^2-y^2}
\]
being $f_\ell(\mathbf{k}) \in \mathbb{C}$ the structure factor at topology $\ell$. Evidently,
\[
	\frac{1}{L_x L_y} \sum_{\mathbf{k} \in \mathrm{BZ}} \Gamma_\mathbf{k} f_{\ell'}^* (\mathbf{k}) \simeq \int_\mathrm{BZ} \frac{d\mathbf{k}}{(2\pi)^2} \Gamma_\mathbf{k} f_{\ell'}^* (\mathbf{k}) = \Gamma^{(\ell)} \delta_{\ell\ell'}
\]
thus, in order to recover $\Gamma^{\ell}$ for a generic $\ell$, using wave decomposition orthogonality rules it suffices to multiply the measured $\Gamma_\mathbf{k}$ by the appropriate structure factor, sum over the BZ and finally divide by the lattice volume.